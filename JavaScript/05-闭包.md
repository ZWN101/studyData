### 如何产生闭包

当一个嵌套的内部（子）函数引用了嵌套的外部（父）函数的变量（函数）时，就产生了闭包

### 什么是闭包

 * 理解一: 闭包是嵌套的内部函数(绝大部分人)
  * 理解二: 包含被引用变量(函数)的对象(极少数人)
  * 注意: 闭包存在于嵌套的内部函数中

### 产生闭包的条件

* 函数嵌套
* 内部函数引用了外部函数的数据（变量/函数）

```js
function fn1(){
    var a=10;
    var b=9;
    function fn2(){   //在执行函数定义时就会产生闭包
        console.log(++a);
    }
    fn2();
}
fn1();
```

### 闭包的三个特性

* 函数嵌套函数
* 函数内部可以引用外部的数据（变量/函数等）
* 参数和变量不会被垃圾回收机制回收

### 常见的闭包

#### 将函数作为另一个函数的返回值

```js
function fun1(){
	var a=1;
	function fun2(){
	   a++;
	   console.log(a);
	}
	return fun2;
}
var f=fun1();
f();//2
var f2=fun1();
f2();//2
```

#### 将函数作为实参传递给另一个函数调用

```js
function showDelay(msg,time){
		setTimeout(function(){
			console.log(msg);
		},time);
}
showDelay("aaaaa",2000);
```

### 闭包的生命周期

* 产生：在嵌套的内部函数定义执行完时产生
* 死亡：在嵌套的内部函数成为垃圾对象时（包含闭包的函数对象成为垃圾对象）

### 闭包的应用

定义JS模块

### 闭包的理解

使用闭包主要是为了设计私有的方法和变量

### 闭包的优点和缺点

* 优点

可以避免全局变量的污染

* 缺点

当函数执行完后，函数内的局部变量会常驻内存，占用内存的时间会变长，容易造成内存泄漏

* 解决

能不用闭包就不用，及时释放

